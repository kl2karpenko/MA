swagger: '2.0'
info:
  title: Kwebbl Mobile App API
  description: Kwebbl Mobile App API
  version: "0.1.0"

# the domain of the service
host: mobile-app.dev.kwebbl.net

# array of all schemes that your API supports
schemes:
  - http
  - https

# will be prefixed to all paths
basePath: /ajax/

consumes:
  - application/json

produces:
  - application/json

securityDefinitions:
  badge-in-header:
    type: apiKey
    name: badge
    in: header
  badge-in-query:
    type: apiKey
    name: badge
    in: query

security:
  - badge-in-header: []
  - badge-in-query: []

parameters:
  _:
    name: _
    in: query
    description: "Timestamp additional parameter for requests"
    required: true
    type: integer

paths:

  /organization/{organization_id}/extensions:
    get:
      summary: List of all company extensions
      parameters:
        - name: organization_id
          in: path
          description: identifier of a organization
          type: string
          required: true
      tags:
        - list
      responses:
        200:
          description: "Returns list of users"
          schema:
            type: object
            properties:
              extensions:
                type: array
                items:
                  $ref: '#/definitions/Extension'

  /organization/{organization_id}/mailboxes:
    get:
      summary: List of all company mailboxes
      parameters:
        - name: organization_id
          in: path
          description: identifier of a organization
          type: string
          required: true
      tags:
        - list
      responses:
        200:
          description: "Returns list of mailboxes"
          schema:
            type: object
            properties:
              mailboxes:
                type: array
                items:
                  $ref: '#/definitions/Mailbox'

  /organization/{organization_id}/dialplans:
    get:
      summary: List of all company dialplans
      parameters:
        - name: organization_id
          in: path
          description: identifier of a organization
          type: string
          required: true
      tags:
        - list
      responses:
        200:
          description: "Returns list of dialplans"
          schema:
            type: object
            properties:
              dialplans:
                type: array
                items:
                  $ref: '#/definitions/Dialplan'


  /organization/{organization_id}/dialplans/{dialplan_id}:
    get:
      summary: Get certain dialplan
      description: Return data about dialplan
      parameters:
        - name: organization_id
          in: path
          description: identifier of a organization
          type: string
          required: true
        - name: dialplan_id
          in: path
          description: identifier of a dialplan
          type: string
          required: true
      responses:
        200:
          description: Return detailed data about dialplan
          schema:
            type: object
            properties:
              dialplan:
                $ref: "#/definitions/Dialplan"

    put:
      summary: Modify active dialplan
      description: Do actions with active dialplan
      parameters:
        - name: organization_id
          in: path
          description: identifier of a organization
          type: string
          required: true
        - name: dialplan_id
          in: path
          description: identifier of a dialplan
          type: string
          required: true
        - name: dialplan
          in: body
          required: true
          schema:
            type: object
            properties:
              dialplan:
                $ref: '#/definitions/Dialplan'
      responses:
        200:
          description: "OK"
          schema:
            type: object
            properties:
              dialplan:
                $ref: '#/definitions/Dialplan'


definitions:

  Extension:
    type: object
    properties:
      _id:
        type: string
      name:
        type: string
      in_number:
        type: number
      image_id:
        type: string

  Mailbox:
    type: object
    properties:
      _id:
        type: string
      name:
        type: string
      color:
        type: number
      number:
        type: number
      type:
        type: string

  Dialplan:
    type: object
    properties:
      _id:
        type: string
      actions:
        type: array
        items:
          type: object
          properties:
            action_id:
              type: string
            value:
              type: object
              properties:
                label:
                  type: string
                short_code:
                  type: string
                is_on:
                  type: boolean
      title:
        type: number
      personal:
        type: number
      ex_number:
        type: string
      follow:
        type: object
        properties:
          original:
            type: object
            properties:
              selected:
                type: boolean
          mobile:
            type: object
            properties:
              selected:
                type: boolean
              value:
                type: object
                properties:
                  number:
                    type: string
          mailbox:
            type: object
            properties:
              is_on:
                type: boolean
              selected:
                type: boolean
              value:
                type: object
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  number:
                    type: string
          contact:
            type: object
            properties:
              selected:
                type: boolean
              value:
                type: object
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  number:
                    type: string
                  type:
                    type: string